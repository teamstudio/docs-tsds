# Analyzer サンプルエージェント

製品に含まれている Teamstudio Reports テンプレート **tmslogs.ntf** には、2 つのサンプルエージェントが用意されています。用意されているこれらの エージェントを実行すると、エージェントがどのように動作するか確認することができます。これらのエージェントは、リアルタイムランかスケジュールランかにかかわらず、Analyzer を動的に呼び出す方法を示します。

これらのエージェントは、ロータススクリプトでコード化された標準のノーツエージェントであり、同じ基本構造を持ちます。エージェントは、分析するファイルと作成する分析結果ファイルをまず決定します。その後、分析関数を呼び出して、Analyzer による処理を開始します。

関数を呼び出すことにより、ファイルおよびその他の必要なパラメータが渡されます。Analyzer スクリプトライブラリには、Analyzer (ndbdean.dll) の起動に必要な定数と関数の宣言が含まれています。

これらのエージェントを修正して、適切なファイルやパスデータを指定することもできます。これらのエージェントを変更するか、コピーしてから変 更することができます。スクリプトライブラリおよびエージェントは、修正を含めて、エージェントを実行するデータベースに置く必要があります。

!!! note
    *“Declaration”* のセクションは変更しないでください。スクリプトライブラリに不具合が生じることがあります。
    
## ダイアログを含む Analyzer サンプルスクリプト
このエージェントでは、入力ファイルと分析結果ファイルの名前を入力す るプロンプトが表示されます。DialogBox 呼び出しでは *AnalyzerDialog* という別名を持つ非表示フォーム *“Analyzer Scripting Sample Dialog”* を使用 して、ファイルデータが取得されます。

この関数は、エージェントを実行する際に、分析するファイルの情報を提供するために使用できます。このデータは、入力ファイルを読み込んだり、サー バーまたはローカルマシンにあるノーツのディレクトリを検索したりする別のテクニックを使用して取得することもできます。このエージェントの実際 のコードについては、Teamstudio Reports テンプレート (tmslogs.ntf) を参照 してください。

## Analyzer サンプルスクリプト (Directory Contents Analyzer)
このエージェントは、サーバーから動的に取得したファイル情報を使用して Analyzer を呼び出す方法を示します。また、ファイルを種類によって一致させる方法を示します。この例を変更して、指定した基準を満たすファイル名やディレクトリを検索することもできます。このエージェントの実際のコードについては、Teamstudio Reports テンプレート (tmslogs.ntf) を参照してください。
